(this["webpackJsonpspothole.authority"]=this["webpackJsonpspothole.authority"]||[]).push([[0],{579:function(e,t,a){e.exports=a(907)},584:function(e,t,a){},800:function(e,t,a){},907:function(e,t,a){"use strict";a.r(t);var n,o,r=a(0),i=a.n(r),l=a(16),c=a.n(l),s=(a(584),a(22)),u=a(23),m=a(25),p=a(26),d=a(63),h=a(940),g=a(930),f=a(116),E=a(947),y=a(31),b=a.n(y),v=a(198),S=a(468),x=a(151),C=a(343),k=a.n(C),w="53865530561-eoook3l9t27uvkec6561d3aolde6mims.apps.googleusercontent.com",j="https://spothole.ml:5000",I=j+"/api/authority/reports/geonear",O=j+"/api/authority/send/email",R=Object(v.a)(Object(v.c)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDZBgT-uZYXzTSkTJbiDcYT4D_XYsS8aUQ&v=3.exp&libraries=geometry,drawing,places,visualization",loadingElement:i.a.createElement("div",{style:{height:"100%"}}),containerElement:i.a.createElement("div",{style:{height:"400px"}}),mapElement:i.a.createElement("div",{style:{height:"100%"}})}),Object(v.d)((function(){return{isOpen:!1,infoIndex:null,selectedReports:[],heatMapOn:!1}}),{onToggleOpen:function(e){var t=e.isOpen;e.infoIndex;return function(e){return{isOpen:!t,infoIndex:e}}},toggleHeatMap:function(e){e.heatMapOn;return function(e){return{heatMapOn:!e}}}}),x.withScriptjs,x.withGoogleMap,Object(v.b)({componentDidMount:function(){var e=this;b.a.post(I,{data:{authorityId:this.props.authorityId}}).then((function(t){var a=t.data.map((function(e){return{location:new google.maps.LatLng(e.latitude,e.longitude),weight:e.severity}}));e.setState({selectedReports:t.data,heatMapData:a})})).catch((function(e){console.info("Unable to create the region map")}))}}))((function(e){return i.a.createElement("div",null,i.a.createElement(S.a,{variant:"contained",color:"primary",onClick:function(){return e.toggleHeatMap(e.heatMapOn,e.heatMapData)},style:{float:"right",marginTop:"20px",marginBottom:"20px",position:"relative"}},"Toogle Heat Map Layer"),i.a.createElement(x.GoogleMap,{defaultZoom:14,defaultCenter:{lat:parseFloat(e.centerLat),lng:parseFloat(e.centerLng)}},e.selectedReports.map((function(t,a){var n;n=parseInt(t.severity)<=3?"https://i.ibb.co/2dzSbjJ/output-onlinepngtools-2.png":parseInt(t.severity)<=6?"https://i.ibb.co/RC2LmDh/output-onlinepngtools-1.png":"https://i.ibb.co/kMZV43H/output-onlinepngtools.png";var o=new window.google.maps.MarkerImage(n,null,null,null,new window.google.maps.Size(48,48));return i.a.createElement(x.Marker,{icon:o,key:a,position:{lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)},onClick:function(){return e.onToggleOpen(a)}},e.isOpen&&e.infoIndex===a&&i.a.createElement(x.InfoWindow,{onCloseClick:e.onToggleOpen,key:a,visible:!0},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"3px",marginRight:"3px"}},i.a.createElement("div",{style:{color:"#212121",paddingRight:"10px",paddingBottom:"10px",fontWeight:"bold",lineHeight:1.5}},"Reported On: ",t.created_date.split(" ")[0],i.a.createElement("hr",{style:{marginTop:"3px",marginBottom:"3px"}}),"Current Status:"," ",t.status.charAt(0).toUpperCase()+t.status.slice(1),i.a.createElement("hr",{style:{marginTop:"3px",marginBottom:"3px"}}),"Reported Severity: ",t.severity,"/10 ",i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(S.a,{color:"primary",variant:"contained",onClick:function(){return e.goToReport(t)}},"Go to Report")),i.a.createElement("div",null,i.a.createElement("img",{src:t.imageURL,width:"200px",style:{border:"2px solid black",borderRadius:"10px",marginRight:"10px",marginBottom:"10px"},alt:"Validated Pothole"})))))})),e.heatMapOn?i.a.createElement(k.a,{data:e.heatMapData,options:{radius:60,opacity:.8}}):i.a.createElement(k.a,{data:e.heatMapData,options:{radius:0,opacity:0}})))})),T=a(99),D=a(931),U=a(935),B=a(933),A=a(932),M=a(939),L=a(17),N=a(471),z=a(936),W=a(938),F=a(937),P=a(81),_=a(521),H=a.n(_),q=a(144),V=a.n(q),Y=a(5),Z=a(946),G=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t){n.setState({value:t}),n.props.updateSeverityValue(t)},n.state={value:n.props.value},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{className:e.root},i.a.createElement(Z.a,{classes:{container:e.slider},value:this.state.value,min:1,max:10,step:1,valueLabelDisplay:"on",onChange:this.handleChange}))}}]),a}(i.a.Component),J=Object(Y.a)({root:{width:"100%"},slider:{padding:"22px 0px"}})(G),K=a(515),X=a.n(K),Q=function(e){return i.a.createElement(P.a,{gutterBottom:!0,style:{marginBottom:e.marginBottom,color:e.color}},i.a.createElement("b",null,e.text," \xa0",e.editIcon&&i.a.createElement(X.a,{style:{marginTop:"-5px"},fontSize:"small"})))},$=a(469),ee=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).makeEmpty=function(){n.setState({content:""}),n.checkRequired(n.textFieldRef.current,"required")},n.checkRequired=function(e,t){var a=e.value.trim();""!==a?n.setState({errorRequired:!1,content:e.value}):n.setState({errorRequired:void 0===t,content:e.value}),n.props.updateDescription(a)},n.state={errorRequired:!1,content:""},n.textFieldRef=i.a.createRef(),e.passMakeEmpty(n.makeEmpty),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(P.a,{style:{marginBottom:"10px",marginTop:"5px"},gutterBottom:!0},"Add Comment"),i.a.createElement($.a,{inputRef:this.textFieldRef,error:this.state.errorRequired,onChange:function(t){return e.checkRequired(t.target)},required:!0,fullWidth:!0,variant:"outlined",placeholder:"Comments on the report/update",multiline:!0,rows:4,rowsMax:50,label:"Additional Comments (Required)",value:this.state.content}))}}]),a}(i.a.Component),te=a(547),ae=function(e){return i.a.createElement("div",{style:{color:"#333"}},i.a.createElement(te.a,{avatar:e.profileURL,side:e.side,messages:e.messageArray}))},ne=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var o;return Object(s.a)(this,a),(o=t.call(this,e)).setDescription=function(e){o.setState({commentText:e}),""===e?o.setState({buttonDisabled:!0}):o.setState({buttonDisabled:!1})},o.getAllComments=function(){b.a.post("https://spothole.ml:5000/api/reports/comments",{data:{caseId:o.state.caseId}}).then((function(e){n.manageCommentData(e.data)})).catch((function(e){console.info("Problem with getting your comments!")}))},o.formatDateTime=function(e){var t=new Date(e),a=t.toLocaleString("en",{month:"long"}),n=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return t.getDate()+" "+a+", "+t.getFullYear()+" @ "+n+" \u2192 \n"},o.manageCommentData=function(e){if(e.length>0){var t=e[0].userType,a=[],r=[],l=1;e.map((function(c){return c.userType===t?(a.push(o.formatDateTime(c.commentDateTime)+c.commentText),t=c.userType):(r.push(i.a.createElement(ae,{messageArray:a,side:n.getChatMessageSide(t),profileURL:o.props.profileURL})),t=c.userType,(a=[]).push(o.formatDateTime(c.commentDateTime)+c.commentText)),l===e.length&&r.push(i.a.createElement(ae,{messageArray:a,profileURL:o.props.profileURL,side:n.getChatMessageSide(t)})),++l,c})),n.setState({commentComponentArray:r})}return!0},o.getChatMessageSide=function(e){return"U"===e?"left":"right"},o.handleSubmit=function(){b.a.post("https://spothole.ml:5000/api/submit/report/comment",{data:o.state}).then((function(e){n.setState({emptyDescriptionBox:!0}),n.state.makeBoxEmptyFunction(),o.getAllComments()})).catch((function(e){console.info("Problem with submitting your comment!")}))},o.makeEmpty=function(e){n.setState({makeBoxEmptyFunction:e})},o.state={commentText:"",caseId:e.caseNumber,userType:"A",buttonDisabled:!0,commentComponentArray:[],emptyDescriptionBox:!1,makeBoxEmptyFunction:""},n=Object(d.a)(o),o.getAllComments(),o}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("br",null),this.state.commentComponentArray.map((function(e,t){return i.a.createElement("div",{key:t},e)})),i.a.createElement("br",null),i.a.createElement(ee,{passMakeEmpty:this.makeEmpty,emptyBox:this.state.emptyDescriptionBox,updateDescription:n.setDescription}),i.a.createElement(S.a,{onClick:function(){return e.handleSubmit()},color:"primary",disabled:this.state.buttonDisabled,style:{fontSize:"15px",fontWeight:"bold"}},"Submit"))}}]),a}(i.a.Component),oe=(a(800),a(334)),re=a(342),ie=a(335),le=["Submitted","Approved","Working","Completed","Cancelled"],ce=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).mapOptions=function(e){var t=le.indexOf(e);return le.slice().splice(t)},n.handleChange=function(e){var t=e.target.value;n.setState({value:t}),n.props.updateSelectedValue(t)},n.capitalize=function(e){for(var t=0,a=(e=e.split(" ")).length;t<a;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")};var o=n.capitalize(e.value);return n.state={value:o,options:n.mapOptions(o)},n}return Object(u.a)(a,[{key:"render",value:function(){return i.a.createElement(oe.a,{variant:"outlined"},i.a.createElement(ie.a,{htmlFor:"outlined-age-native-simple"},"Status"),i.a.createElement(re.a,{fullWidth:!0,native:!0,onChange:this.handleChange,label:"Report Status"},this.state.options.map((function(e,t){return i.a.createElement("option",{value:e},e)}))))}}]),a}(i.a.Component),se=a(934),ue=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleSubmit=function(){var e=n.props.updatedStatus.toLowerCase(),t=n.props.updatedSeverity,a=n.props.caseId;b.a.post("https://spothole.ml:5000/api/authority/update/report",{data:{caseId:a,status:e,severity:t}}).then((function(e){b.a.post("https://spothole.ml:5000/api/submit/report/comment",{data:{commentText:"Authority's Update - [Status: "+o.props.updatedStatus+", Severity: "+t+"] - "+o.state.commentText,caseId:a,userType:"A"}}).then((function(e){console.info("Report Updated");var t="Hi "+o.props.mailToProfileName+",\n\nThere is an update to your report. Please login to check the details. Thanks for being a part of the Spothole community.";b.a.post(O,{data:{emailId:o.props.mailToProfileEmail,subject:"New Notification from Spothole (Your Report Status)",message:t}}).then((function(e){console.info(e.data),window.location.reload()})).catch((function(e){window.location.reload()}))})).catch((function(e){console.info("Unable to Update Report")}))})).catch((function(e){console.info("Unable to Update Report")}))},n.setDescription=function(e){n.setState({commentText:e}),""===e?n.setState({buttonDisabled:!0}):n.setState({buttonDisabled:!1})},n.justClose=function(){n.props.updateCloseDialogState()},n.makeEmpty=function(e){o.setState({makeBoxEmptyFunction:e})},n.state={makeBoxEmptyFunction:"",commentText:"",buttonDisabled:!0},o=Object(d.a)(n),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(D.a,{open:this.props.dialogOpenState,onClose:function(){return e.justClose()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(A.a,{id:"alert-dialog-title"},this.props.title),i.a.createElement(B.a,null,i.a.createElement(P.a,{variant:"body2",color:"textSecondary",component:"p"},i.a.createElement(Q,{text:"Updated Severity \u2192 "+this.props.updatedSeverity,marginBottom:"12px",color:"primary"}),i.a.createElement(Q,{text:"Updated Status \u2192 "+this.props.updatedStatus,marginBottom:"12px",color:"primary"})),i.a.createElement("br",null),i.a.createElement(se.a,{id:"alert-dialog-description"},i.a.createElement(ee,{passMakeEmpty:this.makeEmpty,updateDescription:this.setDescription}),i.a.createElement(S.a,{onClick:function(){return e.handleSubmit()},color:"primary",disabled:this.state.buttonDisabled,style:{fontSize:"15px",fontWeight:"bold"}},"Submit"))),i.a.createElement(U.a,null,i.a.createElement(S.a,{onClick:function(){return e.justClose()},color:this.props.color,autoFocus:!0},this.props.buttonText))))}}]),a}(i.a.Component),me=Object(N.a)({root:{maxWidth:700,margin:"0 auto"},media:{height:140},mediaMap:{height:200},headerTextColor:{color:"white"}});function pe(e){var t=i.a.useState(!1),a=Object(T.a)(t,2),n=a[0],o=a[1],r=i.a.useState(e.data.status),l=Object(T.a)(r,2),c=l[0],s=l[1],u=i.a.useState(e.data.severity),m=Object(T.a)(u,2),p=m[0],d=m[1],h=me(),g="https://maps.googleapis.com/maps/api/staticmap?size=512x512&format=png&style=feature:road.highway%7Celement:geometry%7Cvisibility:simplified%7Ccolor:0xc280e9&style=feature:transit.line%7Cvisibility:simplified%7Ccolor:0xbababa&style=feature:road.highway%7Celement:labels.text.stroke%7Cvisibility:on%7Ccolor:0xb06eba&style=feature:road.highway%7Celement:labels.text.fill%7Cvisibility:on%7Ccolor:0xffffff&visible="+e.data.latitude+","+e.data.longitude+"&markers=color:red%7Clabel:A%7C"+e.data.latitude+","+e.data.longitude+"&key=AIzaSyDZBgT-uZYXzTSkTJbiDcYT4D_XYsS8aUQ&zoom=15";return i.a.createElement(z.a,{style:{border:"2px solid rgba(255,255,255,0.1)"},className:h.root},i.a.createElement(F.a,{className:h.media,image:e.data.imageURL}),i.a.createElement(W.a,null,i.a.createElement(P.a,{variant:"body2",color:"textSecondary",component:"p"},i.a.createElement(Q,{text:"Reported By",marginBottom:"12px",color:h.headerTextColor.color}),i.a.createElement(P.a,{gutterBottom:!0},i.a.createElement("div",null,i.a.createElement(E.a,{alt:e.data.profileName,src:e.data.profileURL,style:{display:"inline-block",verticalAlign:"middle"}}),i.a.createElement("div",{style:{display:"inline-block",position:"relative",top:"3px"}},"\xa0 \xa0 ",e.data.profileName))),i.a.createElement("br",null),i.a.createElement(P.a,{gutterBottom:!0},i.a.createElement(H.a,null),"\xa0 \xa0 ",e.data.dateTime.split(",")[0]),i.a.createElement("br",null),i.a.createElement(P.a,{gutterBottom:!0},i.a.createElement(V.a,null),"\xa0 \xa0 ",e.data.location),i.a.createElement("br",null),i.a.createElement(Q,{text:"Severity Rate",editIcon:!0,marginBottom:"40px",color:h.headerTextColor.color}),i.a.createElement(J,{updateSeverityValue:d,value:e.data.severity}),i.a.createElement("br",null),i.a.createElement(Q,{text:"Report Status",editIcon:!0,marginBottom:"30px",color:h.headerTextColor.color}),i.a.createElement(ce,{value:e.data.status,updateSelectedValue:s}),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("div",null,i.a.createElement(S.a,{onClick:function(){o(!0)},color:"primary",style:{fontSize:"15px",fontWeight:"bold"}},"Make Updates"),i.a.createElement(ue,{dialogOpenState:n,updateCloseDialogState:o,title:"Are you sure you want to update?",content:"Please provide feedback supporting your updates",buttonText:"Close",color:"primary",updatedStatus:c,updatedSeverity:p,caseId:e.data.caseNumber,mailToProfileName:e.data.profileName,mailToProfileEmail:e.data.profileEmail})),i.a.createElement("p",{style:{marginTop:"20px",textAlign:"justify"}},i.a.createElement("hr",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"}}),i.a.createElement(Q,{text:"Complaint Description",marginBottom:"15px",color:h.headerTextColor.color}),e.data.description),i.a.createElement("br",null),i.a.createElement(F.a,{className:h.mediaMap,image:g}),i.a.createElement("br",null),i.a.createElement("hr",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"}}),i.a.createElement(Q,{text:"Comments",marginBottom:"15px",color:h.headerTextColor.color}),i.a.createElement(ne,{caseNumber:e.data.caseNumber,profileURL:e.data.profileURL}))))}function de(e){var t=i.a.useState(!0),a=Object(T.a)(t,2),n=a[0],o=a[1],r=Object(L.a)(),l=Object(M.a)(r.breakpoints.down("xl")),c=function(){o(!1)},s=i.a.useRef(null);return i.a.useEffect((function(){if(n){var e=s.current;null!==e&&e.focus()}}),[n]),i.a.createElement("div",null,i.a.createElement(D.a,{open:n,onClose:c,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",fullScreen:l},i.a.createElement(A.a,{id:"scroll-dialog-title",style:{textAlign:"center"}},"Report # ",e.caseNumber),i.a.createElement(B.a,{dividers:!0},i.a.createElement(pe,{data:e})),i.a.createElement(U.a,null,i.a.createElement(S.a,{onClick:c,color:"primary"},"Close"))))}var he,ge,fe=a(522),Ee=a.n(fe),ye=Object(N.a)((function(e){return{root:{flexGrow:1},paper:{padding:"20px",textAlign:"center",color:e.palette.text.secondary}}})),be=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateDataCounter=function(){b.a.post(I,{data:{authorityId:n.props.authorityId}}).then((function(e){he.setState({dataCounter:e.data.length})}))},n.goToReport=function(e){n.setState({detailedDataModal:""},(function(){n.setState({detailedDataModal:i.a.createElement(de,{imageURL:e.imageURL,dateTime:n.formatDate(e.created_date),location:e.location,description:e.description,severity:e.severity,caseNumber:e.case_id,latitude:e.latitude,longitude:e.longitude,profileURL:e.user_photo_url,profileName:n.capitalize(e.user_full_name),status:n.capitalize(e.status),profileEmail:e.user_email})})}))},n.formatDate=function(e){return new Date(Date.parse(e)).toLocaleString()},n.capitalize=function(e){for(var t=0,a=(e=e.split(" ")).length;t<a;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")},n.state={mapView:"",detailedDataModal:"",authorityAddress:"",authorityName:"",dataCounter:0},he=Object(d.a)(n),n.updateDataCounter(),b.a.post("https://spothole.ml:5000/api/profile/authority/data",{data:{authorityId:n.props.authorityId}}).then((function(e){he.setState({authorityAddress:e.data[0].address,authorityName:e.data[0].name,mapView:i.a.createElement("div",null,i.a.createElement(R,{authorityId:n.props.authorityId,centerLat:e.data[0].latitude,centerLng:e.data[0].longitude,goToReport:n.goToReport,heatMapData:[]}))})})).catch((function(e){console.info("Cannot read authority profile data")})),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{style:{marginTop:"100px"}},i.a.createElement(h.a,null,i.a.createElement(P.a,{gutterBottom:!0,style:{textAlign:"center",fontSize:"2.7em"}},"Track and Update\xa0",i.a.createElement(Ee.a,{style:{fontSize:50},color:"primary"})," ","Reports with Ease"),i.a.createElement("div",null,i.a.createElement("center",null,i.a.createElement(P.a,{variant:"body2",color:"textSecondary",component:"p",style:{textAlign:"center",fontSize:"1.5em",maxWidth:"600px"}},"View potholes reported in your region differentiated using the given legend. Click on any pothole marker to view it's details or update it with the press of a single button.")))),0===this.state.dataCounter&&i.a.createElement("div",{style:{textAlign:"center",fontWeight:"bold",fontSize:"24px",marginTop:"150px",color:"#333"}}," ","No Reports in your Zone yet. ",i.a.createElement("br",null)," You can keep Monitoring this page for ",i.a.createElement("br",null)," New Reports and to Manage them through a Map View."),0!==this.state.dataCounter&&i.a.createElement("div",null,i.a.createElement(h.a,null,i.a.createElement(g.a,{style:{marginTop:"50px"},container:!0,spacing:3},i.a.createElement(g.a,{item:!0,sm:6,xs:12},i.a.createElement(f.a,{style:{padding:"20px",height:"200px"}},i.a.createElement("h3",null,"Authority Details"),i.a.createElement("br",null),i.a.createElement("h6",{style:{color:"grey"}},"Name"),i.a.createElement("h6",null,this.state.authorityName),i.a.createElement("h6",{style:{color:"grey"}},"Address"),i.a.createElement("h6",null,this.state.authorityAddress))),i.a.createElement(g.a,{item:!0,sm:6,xs:12},i.a.createElement(f.a,{style:{padding:"20px",height:"200px"}},i.a.createElement("h3",null,"Map Legend [Severity]"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("div",{style:{display:"flex",justifyContent:"start"}},i.a.createElement("div",null,i.a.createElement("center",null,i.a.createElement(E.a,{variant:"rounded",alt:"High",src:"https://i.ibb.co/kMZV43H/output-onlinepngtools.png",className:e.large}),i.a.createElement("h5",null,"High"))),i.a.createElement("div",{style:{marginLeft:"40px",marginRight:"40px"}},i.a.createElement("center",null,i.a.createElement(E.a,{variant:"rounded",alt:"Medium",src:"https://i.ibb.co/RC2LmDh/output-onlinepngtools-1.png",className:e.large}),i.a.createElement("h5",null,"Medium"))),i.a.createElement("div",null,i.a.createElement("center",null,i.a.createElement(E.a,{variant:"rounded",alt:"Low",src:"https://i.ibb.co/2dzSbjJ/output-onlinepngtools-2.png",className:e.large}),i.a.createElement("h5",null,"Low")))))))),i.a.createElement("br",null),i.a.createElement(h.a,null,i.a.createElement("div",{style:{border:"2px SOLID #2997F7",borderRadius:"5px"}},this.state.mapView)),this.state.detailedDataModal))}}]),a}(i.a.Component),ve=Object(Y.a)(ye)(be),Se=a(322),xe=a(942),Ce=a(941),ke=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={pendingCount:0,cancelledCount:0,approvedCount:0,completedCount:0,inProgressCount:0,address:""},b.a.post(I,{data:{authorityId:n.props.authorityId}}).then((function(e){var t=e.data.filter((function(e){return"completed"===e.status})).length,a=e.data.filter((function(e){return"cancelled"===e.status})).length,o=e.data.filter((function(e){return"working"===e.status})).length,r=e.data.filter((function(e){return"submitted"===e.status})).length,i=e.data.filter((function(e){return"approved"===e.status})).length+o+t;n.setState({cancelledCount:a,approvedCount:i,completedCount:t,inProgressCount:o,pendingCount:r})})),b.a.post("https://spothole.ml:5000/api/profile/authority/data",{data:{authorityId:n.props.authorityId}}).then((function(e){n.setState({address:e.data[0].address})})),n}return Object(u.a)(a,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("center",null,i.a.createElement(z.a,{style:{marginTop:"125px",borderRadius:12,minWidth:256,maxWidth:500,textAlign:"center",marginLeft:"50px",marginRight:"50px"}},i.a.createElement(W.a,null,i.a.createElement(E.a,{style:{width:120,height:120,margin:"auto",marginTop:"15px",marginBottom:"15px"},src:this.props.photoURL}),i.a.createElement("h3",{style:{fontSize:18,fontWeight:"bold",letterSpacing:"0.5px",marginTop:8,marginBottom:0}},this.props.name),i.a.createElement("span",null,i.a.createElement(Ce.a,{style:{fontSize:14,marginBottom:"1em",fontWeight:"bold"},href:"mailto:"+this.props.email},this.props.email)),i.a.createElement("span",{style:{fontSize:14,color:"white",marginTop:"1em",fontWeight:"bold",letterSpacing:"0.5px"}},i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(V.a,null),"\xa0 ",this.state.address)),i.a.createElement(xe.a,{variant:"middle"}),i.a.createElement("br",null),i.a.createElement(Q,{text:"Status Statistics"}),i.a.createElement(Se.a,{style:{display:"flex",justifyContent:"center",marginRight:"100px",marginLeft:"100px"}},i.a.createElement(Se.a,{p:2,flex:"auto"},i.a.createElement("p",{style:{fontSize:12,color:"#9e9e9e",fontWeight:500,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',margin:0}},"Pending"),i.a.createElement("p",{style:{fontSize:20,fontWeight:"bold",marginBottom:4,letterSpacing:"1px"}},this.state.pendingCount)),i.a.createElement(Se.a,{p:2,flex:"auto"},i.a.createElement("p",{style:{fontSize:12,color:"#9e9e9e",fontWeight:500,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',margin:0}},"Approved"),i.a.createElement("p",{style:{fontSize:20,fontWeight:"bold",marginBottom:4,letterSpacing:"1px"}},this.state.approvedCount))),i.a.createElement(Se.a,{display:"flex"},i.a.createElement(Se.a,{p:2,flex:"auto"},i.a.createElement("p",{style:{fontSize:12,color:"#9e9e9e",fontWeight:500,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',margin:0}},"In Progress"),i.a.createElement("p",{style:{fontSize:20,fontWeight:"bold",marginBottom:4,letterSpacing:"1px"}},this.state.inProgressCount)),i.a.createElement(Se.a,{p:2,flex:"auto"},i.a.createElement("p",{style:{fontSize:12,color:"#9e9e9e",fontWeight:500,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',margin:0}},"Completed"),i.a.createElement("p",{style:{fontSize:20,fontWeight:"bold",marginBottom:4,letterSpacing:"1px"}},this.state.completedCount)),i.a.createElement(Se.a,{p:2,flex:"auto"},i.a.createElement("p",{style:{fontSize:12,color:"#9e9e9e",fontWeight:500,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',margin:0}},"Cancelled"),i.a.createElement("p",{style:{fontSize:20,fontWeight:"bold",marginBottom:4,letterSpacing:"1px"}},this.state.cancelledCount))),i.a.createElement("div",{style:{marginLeft:"20px",marginRight:"20px",marginTop:"20px"}}))))}}]),a}(i.a.Component),we=a(263),je=a.n(we),Ie=a(46),Oe=Object(N.a)({root:{minWidth:275,maxWidth:400},title:{fontSize:14},pos:{marginBottom:12}}),Re=["#4285F4","#34A853","#FBBC05","#990099","#EA4335"],Te=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).makeData=function(e){var t={};return e.forEach((function(e){void 0===t[e.status]?t[e.status]=1:t[e.status]+=1})),[{name:"Submitted",value:t.submitted||0},{name:"Approved",value:t.approved||0},{name:"Working",value:t.working||0},{name:"Completed",value:t.completed||0},{name:"Cancelled",value:t.cancelled||0}]},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.classes,t=this.makeData(this.props.data);return i.a.createElement(z.a,{className:e.root},i.a.createElement(W.a,null,i.a.createElement(P.a,{className:e.title,color:"textSecondary",gutterBottom:!0},"Statistics"),i.a.createElement(P.a,{variant:"h5",component:"h2"},"Current Report Status"),i.a.createElement(P.a,{variant:"body2",component:"p"},i.a.createElement(Ie.f,{width:400,height:400},i.a.createElement(Ie.e,{dataKey:"value",isAnimationActive:!0,data:t,cx:200,cy:200,outerRadius:80,label:!0,innerRadius:60,paddingAngle:5},t.map((function(e,t){return i.a.createElement(Ie.c,{stroke:Re[t%Re.length],fill:Re[t%Re.length]})}))),i.a.createElement(Ie.g,null),i.a.createElement(Ie.d,null)),i.a.createElement("br",null),'"region and severity wise status summary"')))}}]),a}(r.PureComponent),De=Object(Y.a)(Oe)(Te),Ue=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).makeData=function(e){for(var t={},a=1;a<=10;a++)t[a]={name:"Sev "+a,submitted:0,approved:0,working:0,completed:0,cancelled:0};return e.forEach((function(e){t[e.severity][e.status]+=1})),Object.values(t)},e}return Object(u.a)(a,[{key:"render",value:function(){var e=window.innerWidth<500?window.innerWidth-75:window.innerWidth/3,t=this.makeData(this.props.data);return i.a.createElement("div",null,i.a.createElement(Ie.b,{width:e,height:542,data:t,margin:{top:20,right:30,left:20,bottom:5}},i.a.createElement(Ie.h,{dataKey:"name"}),i.a.createElement(Ie.i,null),i.a.createElement(Ie.g,null),i.a.createElement(Ie.d,null),i.a.createElement(Ie.a,{dataKey:"submitted",stackId:"a",fill:"#4285F4"}),i.a.createElement(Ie.a,{dataKey:"approved",stackId:"a",fill:"#34A853"}),i.a.createElement(Ie.a,{dataKey:"working",stackId:"a",fill:"#FBBC05"}),i.a.createElement(Ie.a,{dataKey:"completed",stackId:"a",fill:"#990099"}),i.a.createElement(Ie.a,{dataKey:"cancelled",stackId:"a",fill:"#EA4335"})))}}]),a}(r.PureComponent),Be=a(248),Ae=a(929),Me=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).formatDate=function(e){return new Date(Date.parse(e)).toLocaleString()},n.capitalize=function(e){for(var t=0,a=(e=e.split(" ")).length;t<a;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")},n.state={reportsDataTable:"",dataModal:"",completeData:new Array,pieChart:"",barChart:""},ge=Object(d.a)(n),b.a.post(I,{data:{authorityId:n.props.authorityId}}).then((function(e){if(console.log(e.data,"ro8"),console.log(e.data.length),e.data.length>0){console.log(e,"sexxx");var t=e.data;n.setState({completeData:t});var a=t.map((function(e){var t={};return t["Case Id"]=e.case_id,t.Location=n.capitalize(e.location),t.Severity=e.severity,t.Status=n.capitalize(e.status),t["Report Date"]=n.formatDate(e.created_date).split(",")[0],t["Reporter Name"]=n.capitalize(e.user_full_name),t})),o=Object.keys(a[0]),r={filterType:"checkbox",selectableRows:"none",onRowClick:function(e,a){var o=t[a.dataIndex];console.log(o,"sex2"),ge.setState({dataModal:""},(function(){ge.setState({dataModal:i.a.createElement(de,{imageURL:o.imageURL,dateTime:n.formatDate(o.created_date),location:o.location,description:o.description,severity:o.severity,caseNumber:o.case_id,latitude:o.latitude,longitude:o.longitude,profileURL:o.user_photo_url,profileName:n.capitalize(o.user_full_name),status:n.capitalize(o.status),profileEmail:o.user_email})})}))}};ge.setState({reportsDataTable:i.a.createElement(Ae.a,{theme:Object(Be.a)({palette:{type:"dark"},overrides:{MuiTableRow:{root:{cursor:"pointer"}}}})},i.a.createElement(je.a,{title:"Zone Reports",data:a,columns:o,options:r,style:{cursor:"pointer"}})),pieChart:i.a.createElement(De,{data:t}),barChart:i.a.createElement(Ue,{data:t})})}})),n}return Object(u.a)(a,[{key:"render",value:function(){return console.log(this.state.completedData,"hey33"),i.a.createElement("div",null,i.a.createElement(h.a,null,i.a.createElement(g.a,{style:{marginTop:"100px"},container:!0,spacing:3},i.a.createElement(g.a,{item:!0,sm:5},i.a.createElement(f.a,null,this.state.pieChart)),i.a.createElement(g.a,{item:!0,sm:7},i.a.createElement(f.a,null,this.state.barChart)))),i.a.createElement(h.a,{style:{marginTop:"50px"}},this.state.reportsDataTable,this.state.dataModal))}}]),a}(i.a.Component),Le=a(535),Ne=a.n(Le),ze=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).handleClose=function(){e.props.updateUserStatus()},e.justClose=function(){e.props.updateCloseDialogState()},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(D.a,{open:this.props.dialogOpenState,onClose:function(){return e.justClose()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(A.a,{id:"alert-dialog-title"},this.props.title),i.a.createElement(B.a,null,i.a.createElement(se.a,{id:"alert-dialog-description"},this.props.content)),i.a.createElement(U.a,null,i.a.createElement(S.a,{onClick:function(){return e.handleClose()},color:this.props.color,autoFocus:!0},this.props.buttonText),void 0!==this.props.linkTo&&i.a.createElement(S.a,{onClick:function(){return e.justClose()},color:"primary",autoFocus:!0},"No"))))}}]),a}(i.a.Component),We=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).capitalize=function(e){for(var t=0,a=(e=e.split(" ")).length;t<a;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")},n.updateDialogState=function(){n.setState({dialogOpenState:!1})},n.updateUserStatus=function(){b.a.post("https://spothole.ml:5000/api/authority/update/user/status",{data:{userId:n.state.clickedRow[0],status:"Allowed"===n.state.clickedRow[3]?"blocked":"allowed"}}).then((function(e){var t="Hi "+n.state.clickedRow[1]+",\n\nWe have decided to turn your status back to allowed. You can now try signing into your account now. \n\nIf you have additional questions, feel free to send an email to support.spothole@gmail.com. Thank you for being a part of the Spothole community.",a="Hi "+n.state.clickedRow[1]+",\n\nThere seems to be some unusual activity from your account. Your status has to be turned to blocked. \n\nIf you have additional questions, feel free to send an email to support.spothole@gmail.com. Thank you for joining the Spothole community.";b.a.post(O,{data:{emailId:n.state.clickedRow[2],subject:"New Notification from Spothole (Your Account Status)",message:"Allowed"===n.state.clickedRow[3]?a:t}}).then((function(e){console.info(e.data),window.location.reload()}))})).catch((function(e){console.info("Cannot update status currently!")}))},n.state={usersDataTable:"",dialogOpenState:!1,clickedRow:"",dataCounter:0};var o=Object(d.a)(n);return b.a.post(I,{data:{authorityId:n.props.authorityId}}).then((function(e){if(e.data.length>0){var t=e.data,a={},r=t.forEach((function(e){void 0===a[e.userId]&&(a[e.userId]={"User Id":e.userId,Name:n.capitalize(e.user_full_name),Email:e.user_email,"User Status":n.capitalize(e.user_status)})}));r=Object.values(a);var l=[];Object.keys(r[0]).forEach((function(e){var t={name:e,options:{display:"User Id"!==e}};l.push(t)}));var c={filterType:"checkbox",onRowClick:function(e,t){n.setState({dialogOpenState:!0,clickedRow:e})},selectableRows:"none"};o.setState({dataCounter:l.length},(function(){o.setState({usersDataTable:i.a.createElement(Ae.a,{theme:Object(Be.a)({palette:{type:"dark"},overrides:{MuiTableRow:{root:{cursor:"pointer"}}}})},i.a.createElement(je.a,{title:"Users Active in Zone",data:r,columns:l,options:c}))})}))}})),n}return Object(u.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{style:{marginTop:"100px"}},i.a.createElement(h.a,null,i.a.createElement(P.a,{gutterBottom:!0,style:{textAlign:"center",fontSize:"2.7em"}},"Manage and Change\xa0",i.a.createElement(Ne.a,{style:{fontSize:50},color:"primary"})," User Level Permissions"),i.a.createElement("div",null,i.a.createElement("center",null,i.a.createElement(P.a,{variant:"body2",color:"textSecondary",component:"p",style:{textAlign:"center",fontSize:"1.5em",maxWidth:"500"}},"View active users in your region and manage their permissions easily.")))),0===this.state.dataCounter&&i.a.createElement("div",{style:{textAlign:"center",fontWeight:"bold",fontSize:"24px",marginTop:"150px",color:"#333"}}," ","No Active Users in your Zone yet. ",i.a.createElement("br",null)," You can keep monitoring this page ",i.a.createElement("br",null)," for seeing New User Activity."),0!==this.state.dataCounter&&i.a.createElement(h.a,{style:{marginTop:"50px"}},this.state.usersDataTable,i.a.createElement(ze,{dialogOpenState:this.state.dialogOpenState,updateCloseDialogState:this.updateDialogState,title:"Change User Status to "+("Allowed"===this.state.clickedRow[3]?"Blocked":"Allowed"),content:"Are you sure you want to change the status?",buttonText:"Yes, Change Status",linkTo:"/users",updateUserStatus:this.updateUserStatus,color:"secondary"})))}}]),a}(i.a.Component),Fe=a(196),Pe=a(536),_e=a(3),He=a(67),qe=a(944),Ve=a(943),Ye=a(480),Ze=a(914),Ge=a(341),Je=a(537),Ke=a.n(Je),Xe=a(538),Qe=a.n(Xe),$e=a(539),et=a.n($e),tt=a(918),at=a(542),nt=a.n(at),ot=a(541),rt=a.n(ot),it=a(544),lt=a.n(it),ct=a(545),st=a.n(ct),ut=a(543),mt=a.n(ut),pt=a(945),dt=a(483),ht=a(103),gt=Object(N.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(Pe.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},inputRoot:{color:"inherit"},inputInput:Object(Fe.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:120,"&:focus":{width:200}})}}));function ft(){var e=gt(),t=Object(L.a)(),a=i.a.useState(!1),n=Object(T.a)(a,2),o=n[0],r=n[1],l=function(){r(!1)};return i.a.createElement("div",{className:e.root},i.a.createElement(qe.a,null),i.a.createElement(Ve.a,{position:"fixed",className:Object(_e.a)(e.appBar,Object(Fe.a)({},e.appBarShift,o))},i.a.createElement(Ye.a,null,i.a.createElement(Ge.a,{color:"inherit","aria-label":"open drawer",onClick:function(){r(!0)},edge:"start",className:Object(_e.a)(e.menuButton,o&&e.hide)},i.a.createElement(Ke.a,null)),i.a.createElement(P.a,{variant:"h5",noWrap:!0},"Spothole Authority"))),i.a.createElement(He.a,{className:e.drawer,variant:"persistent",anchor:"left",open:o,classes:{paper:e.drawerPaper}},i.a.createElement("div",{className:e.drawerHeader},i.a.createElement(Ge.a,{onClick:l},"ltr"===t.direction?i.a.createElement(Qe.a,null):i.a.createElement(et.a,null))),i.a.createElement(xe.a,null),i.a.createElement(Ze.a,null,i.a.createElement(ht.b,{to:"/mapview"},i.a.createElement(tt.a,{onClick:l,button:!0,key:"Report"},i.a.createElement(pt.a,null,i.a.createElement(rt.a,{color:"primary"})),i.a.createElement(dt.a,{primary:"Map Region View"}))),i.a.createElement(ht.b,{to:"/"},i.a.createElement(tt.a,{onClick:l,button:!0,key:"Dashboard"},i.a.createElement(pt.a,null,i.a.createElement(nt.a,{color:"primary"})),i.a.createElement(dt.a,{primary:"Dashboard"}))),i.a.createElement(ht.b,{to:"/users"},i.a.createElement(tt.a,{onClick:l,button:!0,key:"Manage Users"},i.a.createElement(pt.a,null,i.a.createElement(mt.a,{color:"primary"})),i.a.createElement(dt.a,{primary:"Manage Users"}))),i.a.createElement(ht.b,{to:"/profile"},i.a.createElement(tt.a,{onClick:l,button:!0,key:"Profile"},i.a.createElement(pt.a,null,i.a.createElement(lt.a,{color:"primary"})),i.a.createElement(dt.a,{primary:"Profile"})))),i.a.createElement(ht.b,{to:"/logout"},i.a.createElement(tt.a,{onClick:l,button:!0,key:"Logout"},i.a.createElement(pt.a,null,i.a.createElement(st.a,{color:"primary"})),i.a.createElement(dt.a,{primary:"Logout"})))))}var Et=function(){return i.a.createElement("div",{style:{marginTop:"50px"}})},yt=a(546),bt=a.n(yt),vt=Object(N.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(https://source.unsplash.com/random?road)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),marginTop:"50px",backgroundColor:e.palette.primary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{marginTop:"50px",maxWidth:"250px",paddingTop:"15px",paddingBottom:"15px"}}}));function St(e){var t=vt();return i.a.createElement(g.a,{container:!0,component:"main",className:t.root},i.a.createElement(qe.a,null),i.a.createElement(g.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),i.a.createElement(g.a,{item:!0,xs:12,sm:8,md:5,component:f.a,elevation:6,square:!0,style:{backgroundImage:"url('https://images.unsplash.com/photo-1543839482-a95d35fc5a77?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=900&q=80'), linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6))",backgroundBlendMode:"overlay",borderLeft:"5px SOLID #212121"}},i.a.createElement("div",{className:t.paper},i.a.createElement(P.a,{component:"h1",variant:"h1",style:{marginTop:"100px"}},i.a.createElement("b",null,i.a.createElement(V.a,{fontSize:"inherit"}))),i.a.createElement("br",null),i.a.createElement(P.a,{component:"h1",variant:"h3"},i.a.createElement("b",null,"Spothole")),i.a.createElement("br",null),i.a.createElement(P.a,{component:"h1",variant:"h5",style:{marginTop:"100px"}},i.a.createElement("b",null,"Sign In")),i.a.createElement(S.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:function(){return document.getElementsByClassName("abcRioButton")[0].click()}},i.a.createElement("b",null,"Sign In With Google \xa0",i.a.createElement(bt.a,null))))))}var xt=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).callRender=function(e){window.gapi.load("signin2",(function(){var t={width:0,height:0,client_id:w,onsuccess:e,longTitle:!1,theme:"dark"};gapi.signin2.render("loginButton",t)}))},n.logout=function(e){n.state.isSignedIn?window.gapi.auth2.getAuthInstance().signOut().then((function(){n.setState({isSignedIn:n.auth2.isSignedIn.get()},(function(){localStorage.setItem("authoritySignedIn",!1),n.urlRedirect(e||"http://localhost:3000")}))})):console.info("Already Signed In")},n.urlRedirect=function(e){var t=setTimeout((function(){return window.location.replace(e),!0}),300);return(window.location=e)||(window.location.href=e)?(clearTimeout(t),!0):(clearTimeout(t),window.location.replace(e),!0)},n.validateAndPostProfileData=function(e){b.a.post("https://spothole.ml:5000/api/authority/check",{data:{emailId:e.getEmail()}}).then((function(t){"Authorized Login"===t.data?b.a.post("https://spothole.ml:5000/api/profile/authority/update",{data:{authorityId:e.getId(),emailId:e.getEmail(),name:e.getName(),photoURL:e.getImageUrl()}}):(n.logout("https://nirbhay.me/spothole/404"),console.info("Unauthorized Login"))})).catch((function(e){n.logout(),console.info("Cannot login at this time!")}))},n.navigationBar=function(){return i.a.createElement("div",null," ",i.a.createElement(ft,null),i.a.createElement(Et,null)," ")},n.state={isSignedIn:!1,authorityId:"",profileName:"",profileEmail:"",profilePhotoURL:""},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.onSuccess.bind(this);window.gapi.load("auth2",(function(){e.auth2=gapi.auth2.init({client_id:w}),e.auth2.then((function(){var t=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();e.setState({isSignedIn:e.auth2.isSignedIn.get(),authorityId:t.getId()||"",profileName:t.getName()||"",profileEmail:t.getEmail()||"",profilePhotoURL:t.getImageUrl()||""})}))})),this.callRender(t)}},{key:"onSuccess",value:function(){var e=this,t=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();localStorage.setItem("authoritySignedIn",!0),this.setState({isSignedIn:!0,err:null,authorityId:t.getId(),profileName:t.getName(),profileEmail:t.getEmail(),profilePhotoURL:t.getImageUrl()},(function(){e.validateAndPostProfileData(t)}))}},{key:"onLoginFailed",value:function(e){this.setState({isSignedIn:!1,error:e})}},{key:"loginStatus",value:function(){if("true"===localStorage.getItem("authoritySignedIn")&&this.state.isSignedIn)switch(this.props.linkTo){case"/dashboard":return i.a.createElement("div",null,i.a.createElement(Me,{authorityId:this.state.authorityId}),this.navigationBar());case"/mapview":return i.a.createElement("div",null,i.a.createElement(ve,{authorityId:this.state.authorityId}),this.navigationBar());case"/users":return i.a.createElement("div",null,i.a.createElement(We,{authorityId:this.state.authorityId}),this.navigationBar());case"/logout":this.logout();break;case"/profile":return i.a.createElement("div",null,i.a.createElement(ke,{authorityId:this.state.authorityId,name:this.state.profileName,email:this.state.profileEmail,photoURL:this.state.profilePhotoURL}),this.navigationBar());case"/":default:return i.a.createElement("div",null,i.a.createElement(Me,{authorityId:this.state.authorityId}),this.navigationBar())}else{if("false"!==localStorage.getItem("authoritySignedIn")||!this.state.isSignedIn)return"true"!==localStorage.getItem("authoritySignedIn")?i.a.createElement("div",null,i.a.createElement("div",{id:"loginButton",style:{display:"none"}},"Login with Google"),i.a.createElement(St,null)):i.a.createElement("div",null);this.urlRedirect("http://localhost:3000")}}},{key:"render",value:function(){return i.a.createElement("div",null,this.loginStatus())}}]),a}(r.Component),Ct=a(100),kt=(a(906),function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return window.location.href="https://nirbhay.me/spothole/404",i.a.createElement("div",null,"404")}}]),a}(i.a.Component)),wt=Object(Be.a)({palette:{type:"dark",primary:{main:"#2997f7"},secondary:{main:"#ff0000"}},overrides:{MuiPaper:{root:{backgroundColor:"#333"}},MuiStepper:{root:{padding:"0px"}}}});var jt=function(){return i.a.createElement(Ae.a,{theme:wt},i.a.createElement(ht.a,null,i.a.createElement("div",null,i.a.createElement(Ct.c,null,i.a.createElement(Ct.a,{path:"/mapview",exact:!0},i.a.createElement(xt,{linkTo:"/mapview"})),i.a.createElement(Ct.a,{path:"/profile",exact:!0},i.a.createElement(xt,{linkTo:"/profile"})),i.a.createElement(Ct.a,{path:"/logout",exact:!0},i.a.createElement(xt,{linkTo:"/logout"})),i.a.createElement(Ct.a,{path:"/users",exact:!0},i.a.createElement(xt,{linkTo:"/users"})),i.a.createElement(Ct.a,{path:"/dashboard",exact:!0},i.a.createElement(xt,{linkTo:"/dashboard"})),i.a.createElement(Ct.a,{path:"/",exact:!0},i.a.createElement(xt,{linkTo:"/dashboard"})),i.a.createElement(Ct.a,{path:"*",exact:!0,component:kt})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(jt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[579,1,2]]]);
//# sourceMappingURL=main.cb85ede5.chunk.js.map